<!-- 
    因為估狗表單安全性問題
    所以開啟chrome需要使用下麵ㄉ指令
    
    chrome.exe --user-data-dir="C://Chrome dev session" --disable-web-security
    
    -->
<!doctype html>
<html>
    <head> 
        <meta charset = 'utf-8'>
        <title>台科大程式設計社刷卡報到系統</title>
        <style type="text/css">
            body{
                background-color: black;
                text-align: center;
                text-vertical-align: middle;
            }
            #test{
                font-family:Microsoft JhengHei;
                color: white;
                width: 1000px;
                height: 600px;
                position: absolute;
                top: 50%;
                left: 50%;
                margin: -300px 0 0 -500px;
                font-size: 100px;
            }

        </style>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
        <script>
            var succ1 = "<h2>報到成功!</h2><p>歡迎";
            var succ2 = "</p>"
            var welcome = "<h2>程式設計社課</h2><p>請刷卡報到</p>" 
            var err = "<h2>報到失敗!</h2><p>請檢查您的卡片!</p>" 
            var key = ['866294421',
                    '1671567157',
                    '834448421',
                    '829467141',
                    '829430917',
                    '834460485',
                    '834458597',
                    '866292293',
                    '834511333',
                    '866290933',
                    '686922549',
                    '687403525',
                    '2134575848',
                    '1645658053',
                    '730538757',
                    '1672788229',
                    '1801044456',
                    '686805541',
                    '834516453',
                    '1672177477',
                    '1672187749',
                    '1672170261',
                    '829295397',
                    '829452197',
                    '834516053',
                    '3613720803',
                    '1424347368',
                    '829315429',
                    '671609349',
                    '1672191109',
                    '829447221',
                    '2133302504',
                    '834509381',
                    '1671235349'];
            
            
            //這邊填卡片代號
            var dict = {
                    '罗美恒': '866294421',
                    '傅秉中': '1671567157',
                    '蔡宏駿': '834448421',
                    '秦毓勝': '',
                    '鄭忠琳': '829467141',
                    '洪幸里': '829430917',
                    '陳長祐': '834460485',
                    '蕭丞軒': '834458597',
                    '章世雄': '866292293',
                    '薛仲軒': '834511333',
                    '高佳琳': '',
                    '林子涵': '866290933',
                    '楊為屹': '',
                    '施雅文': '686922549',
                    '田蕙心': '',
                    '李宗澤': '',
                    '李佑芸': '687403525',
                    '范文瑄': '',
                    '鄭哲安': '2134575848',
                    '詹圓圓': '1645658053',
                    '顏志達': '730538757',
                    '李堃豪': '1672788229',
                    '陳庭儀': '1801044456',
                    '蕭瑾涵': '',
                    '陳天心': '',
                    '陳忠岳': '686805541',
                    '李鎔全': '834516453',
                    '陳昭旭': '1672177477',
                    '陳雅喬': '',
                    '何浩宇': '1672187749',
                    '許馨云': '1672170261',
                    '廖章揚': '829295397',
                    '黃治華': '829452197',
                    '利怡萱': '834516053',
                    '朱元翰': '3613720803',
                    '張芸如': '1424347368',
                    '周正欣': '829315429',
                    '詹家旻': '',
                    '胡佳玲': '671609349',
                    '馮若陽': '1672191109',
                    '薛喻文': '',
                    '吳東璋': '',
                    '余佳晏': '829447221',
                    '劉弘裕': '2133302504',
                    '許宸安': '',
                    '陳柏瑜': '834509381',
                    '潘立玄': '1671235349'
                };

            
            
            
            
            
              //這邊填人名、代號對照
            var input = ''
            function sleep(milliseconds) {
                var start = new Date().getTime();
                for (var i = 0; i < 1e7; i++) {
                    if ((new Date().getTime() - start) > milliseconds){
                    break;
                    }
                }
            }

            function if_success(){
                document.getElementById('test').innerHTML= (succ1+dict[input]+succ2);
                //document.getElementById('test').style.color = 'black';
                document.body.style.backgroundColor = "green"; 
            }

            function if_error(){
                document.getElementById('test').innerHTML=err;
                document.body.style.backgroundColor = "red"; 
                console.log(input);
            }

            function wait_and_back(yn){

                /*
                $.post("https://docs.google.com/forms/d/e/1FAIpQLSfBf4qNWgU8cDTU9jI-9AkODQqOJhtv1Px3PSwUQrb7rxF_oA/formResponse",
                {
                    'entry.1177981969':input,
                    'entry.610972581': yn
                });
                */
                url = "https://docs.google.com/forms/d/e/1FAIpQLSfBf4qNWgU8cDTU9jI-9AkODQqOJhtv1Px3PSwUQrb7rxF_oA/formResponse";
                url += "?entry.1177981969=";
                url += input;
                url += "&entry.610972581=";
                url += yn;
                url += "&submit=Submit";

                $.get(url);

                            


                setTimeout(function(){
                    document.getElementById('test').innerHTML=welcome;
                    //document.getElementById('test').style.color = 'white';
                    document.body.style.backgroundColor = "black";
                    input = '';
                    },3000);
             

            }
           

            function check(input){
                if (key.includes(input)){  // key內有input
                    if_success();
                    wait_and_back('Y')
                }
                else{
                    if_error();
                    wait_and_back('N')
                }

            }
          function keyy(e){
                var keycode;
                if (window.event) keycode = window.event.keyCode;
                else if (e) keycode = e.which;
                else return true;
                if (keycode == 13){ // Enter
                    check(input)
                }
                else{
                    //input += String.fromCharCode(keycode);
                    input += String.fromCharCode(keycode);
                }
                  
            }
        </script>
    </head>
    <body onKeyPress="keyy(event)">
        <div id ='test'>
            <h2>程式設計社課</h2>
            <p>請刷卡報到</p>
        </div>
        <textbox id="textArea"></textbox>
</body>
</html>
